import {validateSchema} from '../../src/utils/schema.util';
import {TestFileType} from "../../src/types/testFile.type";

const validTestFile: TestFileType = {
    tests: [
        {
            name: "test",
            description: "test",
            path: "/test/",
            method: "POST",
            params: {
                query: []
            },
            expected: {
                status: 200
            }
        }
    ]
}
const invalidTestFilePath: TestFileType = {
    tests: [
        {
            name: "test",
            description: "test",
            path: "test",
            method: "POST",
            params: {
                query: []
            },
            expected: {
                status: 200
            }
        }
    ]
}
describe('testing schema validation', () => {
    test('valid test object should return success', () => {
        expect(validateSchema(validTestFile)).toStrictEqual({"errors": null, "success": true});
    });
    test('invalid path test object should return error', () => {
        expect(validateSchema(invalidTestFilePath)).toStrictEqual({
            "errors": [
                {
                    "instancePath": "/tests/0/path",
                    "keyword": "pattern",
                    "message": "must match pattern \"^/.*$\"",
                    "params": {
                        "pattern": "^/.*$",
                    },
                    "schemaPath": "#/properties/tests/items/properties/path/pattern",
                },
            ], "success": false
        })
        ;
    });
});
